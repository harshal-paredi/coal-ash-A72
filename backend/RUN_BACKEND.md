# Run Backend (Coal Ash Marketplace)

This document explains how to run the FastAPI backend locally.

## Prerequisites

- Python 3.9+ installed
- Recommended: a virtual environment (venv)
- MongoDB (Atlas or local) connection string
- Node.js is not required for backend, only frontend

## 1) Create and activate a virtual environment (recommended)

Windows (PowerShell):

```powershell
python -m venv .venv
.\.venv\Scripts\Activate.ps1
```

Windows (cmd):

```cmd
python -m venv .venv
.\.venv\Scripts\activate
```

## 2) Install dependencies

```powershell
pip install -r requirements.txt
```

## 3) Environment variables

Create a `.env` file in the `backend/` folder (example already included). Required variables:

```env
MONGODB_URL="your_mongodb_connection_string"
DB_NAME="coal_ash_marketplace"
JWT_SECRET_KEY="your-secret-key"
CORS_ORIGINS="http://localhost:3000"
```

Note: The repository may include a sample `.env.example`. Do not commit secrets.

## 4) Start the backend (development)

From the `backend` folder with the venv activated:

```powershell
# using Python module
python -m uvicorn server:app --reload --host 0.0.0.0 --port 8000

# or using uvicorn directly if installed
uvicorn server:app --reload --host 0.0.0.0 --port 8000
```

If you're using PowerShell and want to run in background (non-blocking):

```powershell
Start-Process -NoNewWindow -FilePath "${env:USERPROFILE}\.venv\Scripts\python.exe" -ArgumentList "-m uvicorn server:app --reload --host 0.0.0.0 --port 8000"
```

## 5) Verify health

Open in browser or use curl:

```
GET http://localhost:8000/health
GET http://localhost:8000/api/health
```

Expected response:

```json
{ "status": "ok", "message": "Backend is running" }
```

## Troubleshooting

- If you see `MONGODB_URL environment variable is required`, ensure `.env` contains `MONGODB_URL` and it is correctly formatted.
- For dependency issues, re-run `pip install -r requirements.txt` and check Python version.
- If port 8000 is in use, change `--port` to another free port.

## Production notes

- Use a process manager (systemd, supervisor, pm2 for Node frontends) in production and set `--workers` as needed.
- Keep secrets in a secure store (Vault, environment variables in the cloud provider).

---

Generated by the project assistant.
